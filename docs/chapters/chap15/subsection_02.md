[メインページ](../../index.markdown)

[章目次](./chap15.md)
## 15.2. グラフ上の組み合わせ最適化

最小頂点被覆問題(MVC)や巡回セールスマン問題(TSP)など, グラフ上の多くの組み合わせ最適化問題はNP困難である. つまり, ( $\mathrm{P} \neq \mathrm{NP}$ の元では)多項式時間で解くことができない したがって, これらの問題には通常, 近似アルゴリズムやヒューリスティックを用いる. 良いヒューリスティックを設計することは, 非常に困難かつ退屈なプロセスであり, 問題特有の知識と試行錯誤が必要になってくる. そのため, ヒューリスティックを自動的に学習することが望ましい. 与えられたサンプルデータからヒューリスティックを学習し, 未知のタスクについて解法をみつけることにグラフニューラルネットワークが活用されている. 次に, いくつかのグラフ上での組み合わせ最適化問題について説明し, どのようにグラフニューラルネットワークが活用されるかについて簡単に紹介する.

-   **最小頂点被覆問題**

    グラフ $\mathcal{G}=\{\mathcal{V}, \mathcal{E}\}$ について, 頂点被覆 $\mathcal{S} \subset \mathcal{V}$ は  $\mathcal{E}$ 内のどのエッジをとっても少なくとも一方の端点が含まれるような頂点集合のことを表す. 最小頂点被覆問題はできる限り少ないノード数となるような頂点被覆を見つけることである.

-   **最大カット問題**

    グラフ $\mathcal{G}=\{\mathcal{V}, \mathcal{E}\}$ について, カット $\mathcal{C}=\{\mathcal{S}, \mathcal{V} / \mathcal{S}\}$ は $\mathcal{V}$ を共通する頂点のない2つの集合 $\mathcal{S}$ と $\mathcal{V} / \mathcal{S}$ に分割する. 対応するカットセットは一方の端点が $\mathcal{S}$ にあり, もう一方の端点が $\mathcal{V} / \mathcal{S}$ にあるようなエッジの部分集合 $\mathcal{E}\_c \in \mathcal{E}$ のことをいう. 最大カット問題は, エッジ $(u, v)$ の重みを $w(u, v)$ としたとき,  $\sum_{(u, v) \in \mathcal{E}\_c} w(u, v)$ で表される, カットセット $\mathcal{E}\_c$ の重みを最大化するようなカット $\mathcal{C}$ を見つけることである.

-   **巡回セールスマン問題**

    道で結ばれた都市の集合について, 巡回セールスマン問題は, すべての都市を一度だけ通り, はじめの都市まで戻ってくる最短経路を見つけることである. ノードは都市, エッジは都市をつなぐ道とするグラフ $\mathcal{G}=\{\mathcal{V}, \mathcal{E}\}$ でモデル化することができる. 都市間の距離はエッジの重みとしてモデル化することができる.

-   **最大独立集合問題**

    グラフ $\mathcal{G}$ について, 独立集合とはどのノード間もエッジで接続されていない頂点集合 $\mathcal{S} \subset \mathcal{V}$ のことをいう. 最大独立集合問題は, ノード数が最大の独立集合を見つけることである.

こららの問題のいくつかは, ノードやエッジのアノテーションをする問題としてモデル化することができる. そのモデル化では, ノードやエッジが解に含まれるかどうかを見分けることが目標とされる. 例えば, 最小頂点被覆問題(MVC)はノードのアノテーション問題(つまりノード分類問題)としてモデル化することができる. 解に含まれるノードは1, 解に含まれないノードは0とアノテーションされる. 同様に, 巡回セールスマン問題はノードを選択する問題かエッジをアノテーションする問題としてモデル化することができる. 豊富な学習データがあれば, グラフニューラルネットワークはこれらの問題に取り組むのに適している. しかし, これらの問題を純粋にノードやエッジのアノテーション問題として直接解こうとすると, 無効な解となる可能性がある. 具体的には, 最大独立集合問題では, 推論過程で, 2つの接続されたノードが同時に1とアノテーションされる可能性があり, これは無効な独立集合になり得る. したがって, 探索ヒューリスティックをグラフニューラルネットワークと一緒に活用することで有効な解を見つける.

(Khalil et al., 2017)では, これらの問題を系列ノードの選択問題としてモデル化し, 強化学習を用いて取り組んでいる. 深層強化学習のフレームワークにおける状態表現のモデル化にグラフニューラルネットワークが用いられている. 解は, 部分解にノードを逐次的に追加していくことで構成される. これらのノードは, 強化学習フレームワークにおける評価関数(解, または部分解の質を測定する)を最大化することで, 貪欲法で随時追加されていく. ノードが選択された後には, そのノードを与えられたタスクの有効な解にまとめ上げるヘルパー関数が用いられる. 例えば, 最大カット問題において, 選択された集合 $\mathcal{S}$ について, その補集合 $\mathcal{V} / \mathcal{S}$ が求められ, 最大カットセットは一方の端点がはじめの集合, もう一方の端点がもう一方の集合となるようなエッジの集合として解が構成される.

強化学習を用いて逐次的にノードを選んでいくのではなく, (Li et al., 2018e)ではノードのアノテーションタスクとしてモデル化されている. 訓練段階では, 各学習データのノードは1か0でアノテーションされている. 1が解の集合に含まれるノードであることを表す. 学習後には, 新しいデータについて, グラフニューラルネットワークモデルは各ノードの確率スコアを出力する. これは解に含まれる可能性を表す. 次に, 貪欲法をもちいて, この確率に基づいて有効な解を逐次的に構成していく. 例えば, 最大独立集合問題では, はじめにノードは確率スコアに基づいて降順にソートとされている. 次に, この順で各ノードのラベルを1, その近傍ノードを0とラベル付けすることを繰り返す. 初めて0とラベル付けされたノードに遭遇した段階で終了する. そして, すべてのラベル付きノード(1または0のラベル)を削除し, 残ったノードを用いて誘導部分グラフを作成する. 上記プロセスをこの誘導部分グラフに対して繰り返す. 全体のプロセスは, グラフのすべてのノードがラベル付けされた時点で終了する.

(Joshi et al., 2019)では, グラフニューラルネットワークを用いてエッジのアノテーションを行い, 巡回セールスマン問題に取り組んでいる. 学習過程では, 各学習データは1か0にアノテーションされている. これはエッジが解に含まれているかどうかを表す. 次に, 推論段階ではこのグラフ内のエッジについて予測スコアを出力する. このスコアを統合し, ビームサーチ法を用いることで巡回セールスマン問題の有効な解を探索する.


[メインページ](../../index.markdown)

[章目次](./chap15.md)

[前の節へ](./subsection_01.md) [次の節へ](./subsection_03.md)


