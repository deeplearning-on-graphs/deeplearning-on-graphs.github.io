[メインページ](../../index.markdown)

[章目次](./chap13.md)
## 13.5. 疾病予測

画像情報, 遺伝情報, 行動情報などを含む医療データは, 疾病メカニズムの解明のために大量に収集され, 共有されるようになっている. 疾病予測のタスクでは, 医療画像データと非画像データを用いて, 患者が疾病かどうかを判断する. 医療画像データは患者のMRI画像である場合が多く, 非画像データは年齢, 性別, 撮影場所などの表現型(遺伝学用語で, 観測可能な特徴や形質の意)データを含む場合が多い. これら2種類の情報は互いに相補的である. したがって, 疾病予測の性能をあげるためには, 両方の情報を効果的に活用することが必要である. 画像データからは患者の疾患に対する特徴が直接的に得られ, 表現型データからは患者間の関連性情報が得られる.

例えば, 年齢が近い患者は年齢が大きく異る患者よりもどうようの結果になる傾向にある(他の条件がすべて同じであれば). グラフを用いることで, これら2つの情報を直感的にモデル化することができる. グラフでは, 患者をノードとして扱い, 画像をノードの特徴, 患者間の関連性をエッジとして扱う. 構築されたグラフについて, 疾病予測タスクは, 半教師ありのノードの二値分類タスクとして扱うことができる. これは, 5.5.1節で紹介したグラフニューラルネットワークモデルで取り組むことができる. 次に, ABIDEデータベース(Di Martino et al., 2014)を例に, グラフを構築する方法を簡単に紹介する(Parisot et al., 2018).

ABIDEデータベースは，世界の様々な場所での患者の神経画像(磁気共鳴機能画像法;fMRI)と表現型データを含んでいる. このデータベースを用いて，患者が健常者であるか，自閉症スペクトラム患者(ASD)であるかを予測することが目的である. 各患者は, グラフ $\mathcal{G}$ のノード $v_i$ としてモデル化される.  $\mathbf{x}\_i$ は対応するfMRI画像から抽出された特徴量を表す. ノード間にエッジを構築する(つまりグラフの隣接行列を構築する)ために, 画像データと非画像の表現型(phenotypic)の計測値 $\mathcal{M}=\left\\{M_h\right\\}\_{h=1}^{H}$ の両方を考慮する:

 $$
 \mathbf{A}_{i, j}=\operatorname{sim}\left(\mathbf{x}_i, \mathbf{x}_j\right) \sum_{h=1}^{H} \gamma_h\left(M_h\left(v_i\right), M_h\left(v_j\right)\right)
    \nonumber $$
 

ここで,  $\mathbf{A}$ は隣接行列であり,  $\operatorname{sim}\left(\mathbf{x}\_i, \mathbf{x}\_j\right)$ は2つのノード $v_i$ と $v_j$ の特徴量の間の類似度合いである.  $M_h\left(v_i\right)$ はノード $v_i$ についての $h$ 番目の表現型計測値で,  $\gamma_h()$ はその類似度合いである. 類似度関数 $\operatorname{sim}\left(\mathbf{x}\_i, \mathbf{x}\_j\right)$ はガウスカーネルでモデル化することができ, 距離が近いノードが高い類似度を持つようにする. ABIDEデータベースでは, データ取得場所, 性別, 年齢の3つの表現型計測値が用いられている( $H=3$ となる). データ取得場所が考慮されているのは, データ取得場所ごとに多様なプロトコルで取得されているため, 異なる場所同士のデータを比較するのが難しいためである. 性別と年齢が考慮されているのは, 性別や年齢による集団差が観測されているためである(Werling and Geschwind, 2013; Kana et al., 2014). 性別とデータ取得場所については,  $\gamma_h()$ はクロネッカーのデルタで定義される. これは2つの入力が一致している場合(つまり, 同じデータ取得場所か同じ性別)のみ1をとり, それ以外の場合には0をとる関数である. 年齢については,  $\gamma_h()$ は次のように定義される:

 $$
 \gamma_h\left(M_h\left(v_i\right), M_h\left(v_j\right)\right)=
    \begin{cases}
    1 & \text { if }\left\|M_h\left(v_i\right)-M_h\left(v_j\right)\right\|<\theta \\ 
    0 & \text { otherwise }         
    \end{cases}
    \nonumber $$
 

ここで,  $\theta$ はあらかじめ設定された閾値である. これは年齢差が $\theta$ よりも小さい患者同士を互いに似ているとみなすことを意味する.


[メインページ](../../index.markdown)

[章目次](./chap13.md)

[前の節へ](./subsection_04.md) [次の節へ](./subsection_06.md)


